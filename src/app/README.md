# Customer Demo App

A simplified Blazor WebAssembly SPA that demonstrates personalized customer recommendations powered by Microsoft Fabric and Cosmos DB.

## Features

- **Customer Selection**: Browse random customers from your Cosmos DB
- **Customer Profiles**: View detailed customer information including loyalty points and preferences
- **Personalized Recommendations**: Display ML-generated recommendations from the Microsoft Fabric pipeline
- **Responsive Design**: Modern Bootstrap UI that works on all devices

## Prerequisites

- .NET 8.0 SDK
- Azure Cosmos DB account with customer data
- Customer data populated using the lab exercises

## Setup Instructions

### 1. Configure Cosmos DB Connection

Update the connection details in `Program.cs`:

```csharp
var cosmosConnectionString = "YOUR_COSMOS_DB_CONNECTION_STRING_HERE";
var databaseName = "YOUR_DATABASE_NAME";
var containerName = "customers";
```

You can find your Cosmos DB connection string in:
- Azure Portal → Your Cosmos DB Account → Keys → Primary Connection String

### 2. Customer Data Format

The app expects customer data in this JSON format:

```json
{
  "id": "customer001",
  "customerId": "C001",
  "name": "John Doe",
  "email": "john@example.com",
  "loyaltyPoints": 1250,
  "lastPurchaseDate": "2024-01-15T10:30:00Z",
  "preferences": {
    "favoriteDrink": "Espresso",
    "airport": "SEA",
    "dietaryRestrictions": ["vegan"],
    "notificationPreferences": {
      "email": true,
      "push": false
    }
  },
  "recommendations": [
    {
      "menuItemId": "M001",
      "name": "Almond Milk Latte",
      "score": 0.95,
      "reason": "Based on your vegan preference and coffee history"
    }
  ],
  "registeredAt": "2023-06-01T09:00:00Z",
  "updatedAt": "2024-01-15T10:30:00Z"
}
```

### 3. Run the Application

```bash
# Navigate to the app directory
cd src/app

# Restore dependencies
dotnet restore

# Run the application
dotnet run
```

The app will start at `https://localhost:5001` (or as displayed in the console).

## Project Structure

```
src/app/
├── Models/
│   └── Customer.cs              # Customer data models
├── Services/
│   └── CosmosDbService.cs       # Cosmos DB data access
├── Pages/
│   └── Home.razor               # Main customer display page
├── Shared/
│   └── MainLayout.razor         # Application layout
├── wwwroot/
│   ├── index.html               # Entry point
│   ├── app.css                  # Custom styles
│   └── appsettings.json         # Configuration template
├── App.razor                    # Root component
├── Program.cs                   # Application startup
└── _Imports.razor               # Global using statements
```

## Customization

### Styling
- Modify `wwwroot/app.css` for custom styles
- The app uses Bootstrap 5.3 for responsive design
- CSS custom properties are used for consistent theming

### Data Display
- Update `Pages/Home.razor` to modify the customer information layout
- Add new customer properties by updating the `Customer` model
- Customize recommendation display format

### Cosmos DB Queries
- Modify `CosmosDbService.cs` to change how customers are retrieved
- Add filtering or sorting capabilities
- Implement pagination for large datasets

## Troubleshooting

### Common Issues

1. **Connection Errors**
   - Verify your Cosmos DB connection string is correct
   - Ensure your Cosmos DB account allows connections from your location
   - Check that the database and container names match your setup

2. **No Data Displayed**
   - Confirm customer data exists in your container
   - Verify the JSON structure matches the expected format
   - Check browser console for JavaScript errors

3. **Build Errors**
   - Ensure .NET 8.0 SDK is installed
   - Run `dotnet restore` to install dependencies
   - Check that all required NuGet packages are available

### Logs and Debugging

The app logs errors to the browser console. Open Developer Tools (F12) to view detailed error messages.

## Integration with Lab Exercises

This demo app showcases data from:
- **Exercise 1**: Cosmos DB setup and initial data load
- **Exercise 2**: Eventstreams and real-time data processing  
- **Exercise 3**: KQL Database analytics
- **Exercise 4**: Data Warehouse integration
- **Exercise 5**: ML personalization and reverse ETL

The recommendations displayed are generated by the personalization model built in Exercise 5.